{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"MPH MPH ( M INQUE for P artitioning H eritability) is a C++ program for fast REML estimation of genetic variance components. The method has the following properties: It is fast and memory-efficient. It has robust convergence. It supports the analyses of dominance, epistasis, and genetic correlation. It can perform complex genome-partitioning of quantitative genetic variation. Citation TBA License MPH is distributed under the GPL-3.0 license . Author and contact Jicai Jiang If you want to submit a issue concerning the software please do so using the MPH Github repository .","title":"Home"},{"location":"#mph","text":"MPH ( M INQUE for P artitioning H eritability) is a C++ program for fast REML estimation of genetic variance components. The method has the following properties: It is fast and memory-efficient. It has robust convergence. It supports the analyses of dominance, epistasis, and genetic correlation. It can perform complex genome-partitioning of quantitative genetic variation.","title":"MPH"},{"location":"#citation","text":"TBA","title":"Citation"},{"location":"#license","text":"MPH is distributed under the GPL-3.0 license .","title":"License"},{"location":"#author-and-contact","text":"Jicai Jiang If you want to submit a issue concerning the software please do so using the MPH Github repository .","title":"Author and contact"},{"location":"examples/","text":"Datasets QTL-MAS 2012 The data set is available for download here . This article describes how the data set was simulated. 3k related animals, 10k SNPs, 5 chromosomes, and 3 traits Simulated sequence genotypes The data set is available for download here . Sequence genotypes were simulated by genosim . 10k unrelated individuals, 5M sequence variants, and 30 chromosomes Functional annotations were quickly simulated by assigning LDSC baseline annotations to the simulated sequence variants in order. Phenotypes were simulated using the S-LDSC baseline model enrichment estimates for human traits ( Source data to Fig.4 in this article ). The enrichment estimates were used to compute variance component (VC) estimates for intercept and 24 main functional annotations. The VC estimates were set as true values in phenotype simulation . A small value was added to intercept's VC to enhance the positive definiteness of the all-in-one GRM. Partitioning h 2 by chromosomes Dominance and epistasis Genetic correlation Functional annotations","title":"Examples"},{"location":"examples/#datasets","text":"","title":"Datasets"},{"location":"examples/#qtl-mas-2012","text":"The data set is available for download here . This article describes how the data set was simulated. 3k related animals, 10k SNPs, 5 chromosomes, and 3 traits","title":"QTL-MAS 2012"},{"location":"examples/#simulated-sequence-genotypes","text":"The data set is available for download here . Sequence genotypes were simulated by genosim . 10k unrelated individuals, 5M sequence variants, and 30 chromosomes Functional annotations were quickly simulated by assigning LDSC baseline annotations to the simulated sequence variants in order. Phenotypes were simulated using the S-LDSC baseline model enrichment estimates for human traits ( Source data to Fig.4 in this article ). The enrichment estimates were used to compute variance component (VC) estimates for intercept and 24 main functional annotations. The VC estimates were set as true values in phenotype simulation . A small value was added to intercept's VC to enhance the positive definiteness of the all-in-one GRM.","title":"Simulated sequence genotypes"},{"location":"examples/#partitioning-h2-by-chromosomes","text":"","title":"Partitioning h2 by chromosomes"},{"location":"examples/#dominance-and-epistasis","text":"","title":"Dominance and epistasis"},{"location":"examples/#genetic-correlation","text":"","title":"Genetic correlation"},{"location":"examples/#functional-annotations","text":"","title":"Functional annotations"},{"location":"install/","text":"Source code The mph source code is hosted on Github . Installation Binary executables Binary executables are available in the Releases . mph is statically compiled with Intel oneAPI Base & HPC Toolkit 2023.1 and Eigen 3.4.0 on Ubuntu 22. mph should be executable. Type chmod +x mph on the command line if needed. Compilation of mph Requirements Linux x86_64 Intel oneAPI Base & HPC Toolkit Eigen >= 3.4.0 Change the Eigen path in Makefile . On the command line type make while in the directory containing the Makefile . This should produce the executable named mph . For Windows Windows Subsystem for Linux (WSL) can be used to run MPH on a Windows machine. Install Linux on Windows with WSL Ubuntu will be installed by default, and other Linux distributions are available. Run pre-compiled MPH binaries on a WSL Linux distribution as on a Linux machine.","title":"Install"},{"location":"install/#source-code","text":"The mph source code is hosted on Github .","title":"Source code"},{"location":"install/#installation","text":"","title":"Installation"},{"location":"install/#binary-executables","text":"Binary executables are available in the Releases . mph is statically compiled with Intel oneAPI Base & HPC Toolkit 2023.1 and Eigen 3.4.0 on Ubuntu 22. mph should be executable. Type chmod +x mph on the command line if needed.","title":"Binary executables"},{"location":"install/#compilation-of-mph","text":"Requirements Linux x86_64 Intel oneAPI Base & HPC Toolkit Eigen >= 3.4.0 Change the Eigen path in Makefile . On the command line type make while in the directory containing the Makefile . This should produce the executable named mph .","title":"Compilation of mph"},{"location":"install/#for-windows","text":"Windows Subsystem for Linux (WSL) can be used to run MPH on a Windows machine. Install Linux on Windows with WSL Ubuntu will be installed by default, and other Linux distributions are available. Run pre-compiled MPH binaries on a WSL Linux distribution as on a Linux machine.","title":"For Windows"},{"location":"options/","text":"Note Option names may be abbreviated if the abbreviation is unique or is an exact match for some defined option; e.g., --phenotype works the same as --phenotype_file . Making a GRM from genotypes Input Option Argument Type Description --binary_genotype_file FILE PREFIX Required PLINK bed/bim/fam filename prefix --snp_info_file FILE Required SNP info file in CSV format --snp_weight_name STRING Optional Must be a column header in the SNP info file and specify which column to use for weighting SNPs in a GRM. If not set, all variants in the SNP info file will be used with a weight of 1. --min_maf FLOAT Optional Filter out all variants with minor allele frequency (MAF) less than or equal to the provided threshold [default=0] --min_hwe_pval FLOAT Optional Filter out all variants which have Hardy-Weinberg equilibrium exact test p-value below the provided threshold [default=0] Genotype files MPH uses PLINK bim/fam/bed files for genotypes. The bed/bim/fam file format is described on the PLINK website . SNP info file This CSV file must have a header line. The first column lists SNP IDs. Each of other columns corresponds to one GRM and each row corresponds to a SNP. In the example of partitioning heritability by chromosomes , chr.snp_info.csv has five columns for five chromosomes. If a SNP does not belong to a GRM, leave the corresponding cell empty . If a SNP belongs to n GRMs, put 1 in each of the n cells. To partition SNP heritability by functional annotations , create a SNP info file in which each column (or GRM) represents a category of a functional annotation. Functional annotations may overlap; for example, if a SNP belongs to 6 functional annotation categories, put 1 in each of those 6 cells. Options Option Argument Type Description --make_grm FLAG Required To make a GRM from genotypes --dominance FLAG Optional Flag to make a dominance GRM rather than an additive GRM --num_threads INT Optional Number of computational threads to use [default=1] Output Option Argument Type Description --output_file FILE PREFIX Required Output filename prefix Two files will be generated for a GRM: one with the suffix .grm.iid and the other with .grm.bin . Making a GRM from GRMs Input Option Argument Type Description --grm_list FILE Required Space-delimited text file listing GRMs that have been made The GRM list file is a space-delimited text file, such as AD.grms.txt . It has no header and one or two columns. The first column must be the file path for each GRM. The second column is optional and can be a short GRM identifier for --make_fore and --make_core . Options Option Argument Type Description --merge_grms FLAG Optional Flag to merge a list of GRMs --deduct_grms FLAG Optional Flag to deduct the subsequent GRMs from the first in a list --make_fore FLAG Optional Flag to make first-order interaction GRMs --make_core FLAG Optional Flag to make GRMs for covariances between random effects --num_threads INT Optional Number of computational threads to use [default=1] If a SNP is used in multiple GRMs, the SNP will be treated to be multiple identical SNPs in the resulting GRM of --merge_grms . Output Option Argument Type Description --output_file FILE PREFIX Required Output filename prefix --merge_grms and --deduct_grms generate one GRM. --make_fore generates n ( n +1)/2 GRMs for n GRMs in a GRM list. --make_core generates n ( n -1)/2 GRMs for n GRMs in a GRM list. REML/MINQUE Input Option Argument Type Description --grm_list FILE Required Space-delimited text file listing GRMs that have been made --phenotype_file FILE Required Phenotype file in CSV format --trait STRING Required Must be a column header in the phenotype file and specify which trait to analyze --error_weight_name STRING Optional Must be a column header in the phenotype file and specify which column contains individual error variance weights --covariate_file FILE Optional Covariate file in CSV format --covariate_names STRING Optional Comma-separated list of covariates to include in the analysis GRM list file The GRM list file is a space-delimited text file, such as chr.grms.txt . It has no header and one or two columns. The first column must be the file path for each GRM. The second column is optional and can list an initial variance component (VC) value for each GRM. Phenotype file The phenotype file is a CSV file with a header line. The first column must be the individual ID. The header line needs to contain trait names. Missing values of phenotypes need to be left empty. Do not use space, -9, NA, or NaN. MPH has --error_weight_name to accommodate individual reliabilies ( r 2 ) for pseudo-phenotypes (e.g., de-regressed estimated breeding values). The error weights can be set to 1/ r 2 -1 and kept as a column of the phenotype file. Covariate file The covariate file is a CSV file with a header line. The first column must be the individual ID. The header line needs to contain covariate names. Missing values of covariates need to be left empty. Do not use space, -9, NA, or NaN. If --covariate_names all is specified, MPH will use as covariates all columns from the 2nd to the last in the covariate file. Options Option Argument Type Description --minque FLAG Required Flag to run REML or iterative MINQUE --save_memory FLAG Optional Flag to enable the memory-saving mode --num_threads INT Optional Number of computational threads to use [default=1] --heritability FLOAT Optional Initial heritability value in REML iterations [default=0.5] --exact_init FLAG Optional Flag to set initial VC values to the exact values of the GRM list file's second column rather than their ratios --num_iterations INT Optional Max number of REML iterations [default=20] --tol FLOAT Optional Absolute convergence tolerance for REML log-likelihood [default=0.01] --num_random_vectors INT Optional Number of random probing vectors for stochastic trace estimation [default=100] --seed INT Optional Random seed in stochastic trace estimation [default=0] To force MINQUE(0) or MINQUE(1), set --num_iterations 1 . The second column of the GRM list file should be set to 0 for MINQUE(0) and 1 for MINQUE(1). The memory-saving mode (--save_memory) is not necessarily slower, particularly on a solid-state drive. Output Option Argument Type Description --output_file FILE PREFIX Required Output filename prefix Four files are generated, as shown below. Filename suffix Description .mq.blue.csv Best linear unbiased estimates of fixed effects .mq.iter.csv Summary of REML iterations .mq.vc.csv Variance component estimates .mq.py.csv Residuals of the linear mixed model .mq.vc.csv has the following columns. Column Description name Name of the variance component or GRM m Weighted number of SNPs in the GRM var Estimate of the variance component seV Standard error of the variance component estimate pve Estimate of the proportion of variance explained seP Standard error of the estimate of the proportion of variance explained enrichment Estimate of the per-SNP heritability enrichment seE Standard error of the estimate of the per-SNP heritability enrichment General relationship matrix The --grm_list file can list any general relationship matrix, not necessarily a genomic relationship matrix. Scripts are provided to convert a general relationship matrix to the MPH format. Simulation Simulating phenotypes based on a list of GRMs mph --simulate --num_phenotypes 100 --grm_list chr.grms.txt --heritability 0.5 --output sim_pheno In the i th row of the GRM list file are GRM( i ) and VC( i ). MPH simulates total genetic values ( g ) by sampling g from N( 0 , V ) in which V is equal to the sum of all GRM( i )*VC( i ). MPH further simulates phenotypes by adding an error term ( e ) to g based on heritability. Prediction Empirical best linear unbiased predictions (EBLUPs) mph --pred --mq_file milk.chr --output milk.chr MPH computes EBLUPs using the output of --minque and outputs them to a file with a suffix of .mq.blup.csv. For genomic partitioning, EBLUPs are the estimates of direct genomic values.","title":"Documentation"},{"location":"options/#making-a-grm-from-genotypes","text":"","title":"Making a GRM from genotypes"},{"location":"options/#input","text":"Option Argument Type Description --binary_genotype_file FILE PREFIX Required PLINK bed/bim/fam filename prefix --snp_info_file FILE Required SNP info file in CSV format --snp_weight_name STRING Optional Must be a column header in the SNP info file and specify which column to use for weighting SNPs in a GRM. If not set, all variants in the SNP info file will be used with a weight of 1. --min_maf FLOAT Optional Filter out all variants with minor allele frequency (MAF) less than or equal to the provided threshold [default=0] --min_hwe_pval FLOAT Optional Filter out all variants which have Hardy-Weinberg equilibrium exact test p-value below the provided threshold [default=0]","title":"Input"},{"location":"options/#genotype-files","text":"MPH uses PLINK bim/fam/bed files for genotypes. The bed/bim/fam file format is described on the PLINK website .","title":"Genotype files"},{"location":"options/#snp-info-file","text":"This CSV file must have a header line. The first column lists SNP IDs. Each of other columns corresponds to one GRM and each row corresponds to a SNP. In the example of partitioning heritability by chromosomes , chr.snp_info.csv has five columns for five chromosomes. If a SNP does not belong to a GRM, leave the corresponding cell empty . If a SNP belongs to n GRMs, put 1 in each of the n cells. To partition SNP heritability by functional annotations , create a SNP info file in which each column (or GRM) represents a category of a functional annotation. Functional annotations may overlap; for example, if a SNP belongs to 6 functional annotation categories, put 1 in each of those 6 cells.","title":"SNP info file"},{"location":"options/#options","text":"Option Argument Type Description --make_grm FLAG Required To make a GRM from genotypes --dominance FLAG Optional Flag to make a dominance GRM rather than an additive GRM --num_threads INT Optional Number of computational threads to use [default=1]","title":"Options"},{"location":"options/#output","text":"Option Argument Type Description --output_file FILE PREFIX Required Output filename prefix Two files will be generated for a GRM: one with the suffix .grm.iid and the other with .grm.bin .","title":"Output"},{"location":"options/#making-a-grm-from-grms","text":"","title":"Making a GRM from GRMs"},{"location":"options/#input_1","text":"Option Argument Type Description --grm_list FILE Required Space-delimited text file listing GRMs that have been made The GRM list file is a space-delimited text file, such as AD.grms.txt . It has no header and one or two columns. The first column must be the file path for each GRM. The second column is optional and can be a short GRM identifier for --make_fore and --make_core .","title":"Input"},{"location":"options/#options_1","text":"Option Argument Type Description --merge_grms FLAG Optional Flag to merge a list of GRMs --deduct_grms FLAG Optional Flag to deduct the subsequent GRMs from the first in a list --make_fore FLAG Optional Flag to make first-order interaction GRMs --make_core FLAG Optional Flag to make GRMs for covariances between random effects --num_threads INT Optional Number of computational threads to use [default=1] If a SNP is used in multiple GRMs, the SNP will be treated to be multiple identical SNPs in the resulting GRM of --merge_grms .","title":"Options"},{"location":"options/#output_1","text":"Option Argument Type Description --output_file FILE PREFIX Required Output filename prefix --merge_grms and --deduct_grms generate one GRM. --make_fore generates n ( n +1)/2 GRMs for n GRMs in a GRM list. --make_core generates n ( n -1)/2 GRMs for n GRMs in a GRM list.","title":"Output"},{"location":"options/#remlminque","text":"","title":"REML/MINQUE"},{"location":"options/#input_2","text":"Option Argument Type Description --grm_list FILE Required Space-delimited text file listing GRMs that have been made --phenotype_file FILE Required Phenotype file in CSV format --trait STRING Required Must be a column header in the phenotype file and specify which trait to analyze --error_weight_name STRING Optional Must be a column header in the phenotype file and specify which column contains individual error variance weights --covariate_file FILE Optional Covariate file in CSV format --covariate_names STRING Optional Comma-separated list of covariates to include in the analysis","title":"Input"},{"location":"options/#grm-list-file","text":"The GRM list file is a space-delimited text file, such as chr.grms.txt . It has no header and one or two columns. The first column must be the file path for each GRM. The second column is optional and can list an initial variance component (VC) value for each GRM.","title":"GRM list file"},{"location":"options/#phenotype-file","text":"The phenotype file is a CSV file with a header line. The first column must be the individual ID. The header line needs to contain trait names. Missing values of phenotypes need to be left empty. Do not use space, -9, NA, or NaN. MPH has --error_weight_name to accommodate individual reliabilies ( r 2 ) for pseudo-phenotypes (e.g., de-regressed estimated breeding values). The error weights can be set to 1/ r 2 -1 and kept as a column of the phenotype file.","title":"Phenotype file"},{"location":"options/#covariate-file","text":"The covariate file is a CSV file with a header line. The first column must be the individual ID. The header line needs to contain covariate names. Missing values of covariates need to be left empty. Do not use space, -9, NA, or NaN. If --covariate_names all is specified, MPH will use as covariates all columns from the 2nd to the last in the covariate file.","title":"Covariate file"},{"location":"options/#options_2","text":"Option Argument Type Description --minque FLAG Required Flag to run REML or iterative MINQUE --save_memory FLAG Optional Flag to enable the memory-saving mode --num_threads INT Optional Number of computational threads to use [default=1] --heritability FLOAT Optional Initial heritability value in REML iterations [default=0.5] --exact_init FLAG Optional Flag to set initial VC values to the exact values of the GRM list file's second column rather than their ratios --num_iterations INT Optional Max number of REML iterations [default=20] --tol FLOAT Optional Absolute convergence tolerance for REML log-likelihood [default=0.01] --num_random_vectors INT Optional Number of random probing vectors for stochastic trace estimation [default=100] --seed INT Optional Random seed in stochastic trace estimation [default=0] To force MINQUE(0) or MINQUE(1), set --num_iterations 1 . The second column of the GRM list file should be set to 0 for MINQUE(0) and 1 for MINQUE(1). The memory-saving mode (--save_memory) is not necessarily slower, particularly on a solid-state drive.","title":"Options"},{"location":"options/#output_2","text":"Option Argument Type Description --output_file FILE PREFIX Required Output filename prefix Four files are generated, as shown below. Filename suffix Description .mq.blue.csv Best linear unbiased estimates of fixed effects .mq.iter.csv Summary of REML iterations .mq.vc.csv Variance component estimates .mq.py.csv Residuals of the linear mixed model .mq.vc.csv has the following columns. Column Description name Name of the variance component or GRM m Weighted number of SNPs in the GRM var Estimate of the variance component seV Standard error of the variance component estimate pve Estimate of the proportion of variance explained seP Standard error of the estimate of the proportion of variance explained enrichment Estimate of the per-SNP heritability enrichment seE Standard error of the estimate of the per-SNP heritability enrichment","title":"Output"},{"location":"options/#general-relationship-matrix","text":"The --grm_list file can list any general relationship matrix, not necessarily a genomic relationship matrix. Scripts are provided to convert a general relationship matrix to the MPH format.","title":"General relationship matrix"},{"location":"options/#simulation","text":"Simulating phenotypes based on a list of GRMs mph --simulate --num_phenotypes 100 --grm_list chr.grms.txt --heritability 0.5 --output sim_pheno In the i th row of the GRM list file are GRM( i ) and VC( i ). MPH simulates total genetic values ( g ) by sampling g from N( 0 , V ) in which V is equal to the sum of all GRM( i )*VC( i ). MPH further simulates phenotypes by adding an error term ( e ) to g based on heritability.","title":"Simulation"},{"location":"options/#prediction","text":"Empirical best linear unbiased predictions (EBLUPs) mph --pred --mq_file milk.chr --output milk.chr MPH computes EBLUPs using the output of --minque and outputs them to a file with a suffix of .mq.blup.csv. For genomic partitioning, EBLUPs are the estimates of direct genomic values.","title":"Prediction"},{"location":"performance/","text":"Performance","title":"Performance"},{"location":"performance/#performance","text":"","title":"Performance"},{"location":"util/","text":"Auxiliary scripts","title":"Utilities"},{"location":"util/#auxiliary-scripts","text":"","title":"Auxiliary scripts"}]}